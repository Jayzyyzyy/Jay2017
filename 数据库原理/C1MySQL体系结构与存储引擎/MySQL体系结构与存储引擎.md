# MySQL体系结构与存储引擎 #

## 一、数据库与实例 ##

1. 数据库：

	物理操作系统文件或其他形式文件类型的集合。在MySQL数据库中，数据库文件可以是frm、MYD、MYI、ibd结尾的文件。

2. 实例：

	MySQL数据库实例是由后台线程以及一个共享内存区域组成的。数据库实例是真正用于操作数据库文件的。

3. MySQL
	
	1. 数据库实例在系统上表现为一个进程。MySQL设计为单进程多线程架构。

		ps -ef | grep mysqld (ps -ef指显示进程，|表示管道，grep条件过滤)

	2. 启动数据库的时候，MySql会读取配置文件，它会根据配置文件的参数来启动数据库。在MySql数据库中，可以没有配置文件参数，在这种情况下，MySql会按照编译时的默认参数设置启动实例。

	3. 配置文件中有一个参数是datadir，该参数指定了数据库在磁盘中将数据所存储的目录。

## 二、MySQL体系结构 ##

![1](http://img.blog.csdn.net/20170310195657870?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTGludXhfZXZlcg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

可见，MySQL由以下几部分组成:

	1、连接池组件 
	2、管理服务和工具组件 
	3、SQL接口组件 
	4、查询分析器组件 
	5、优化器组件 
	6、缓冲（Cache）组件 
	7、插件式存储引擎 
	8、物理文件

<font color=red>MySQL存储引擎是基于表的，而不是数据库。</font>

## 三、MySQL存储引擎 ##

插件式存储引擎的好处是每个存储引擎有各自的特点，能够根据具体的应用建立不同的存储引擎表。

1. InnoDB存储引擎

	(1)InnoDB存储引擎**支持事务**，其设计目标主要面向**在线事务处理(OLTP)的应用**。其特点是行**锁设计、支持外键**，并支持类似于Oracle的非锁定读，即默认读取操作不会产生锁。

	(2)InnoDB存储引擎通过使用多版本并发控制来获得高并发性，并且实现了SQL标准的4中隔离级别，**默认是repeatable级别**。同时，InnoDB存储引擎使用一种被称为next-key locking的策略来避免幻读现象的产生。InnoDB存储引擎还提供了插入缓冲、二次写、自适应哈希索引、预读等高性能和高可用的功能。

	(3)对于表中数据的存储，InnoDB存储引擎采用了**聚集**的方式，因此每张表的存储都是按照主键的顺序进程存放。如果没有显式地在表定义时指定主键，InnoDB存储引擎会为每一行生成一个6字节的ROWID，并以此作为主键。

2. MyISAM存储引擎

	(1)MyISAM存储引擎**不支持事务、表锁设计，支持全文索引，主要面向一些OLAP数据库应用**。 
	(2)MyISAM存储引擎另一个与众不同的地方是它的缓冲池只缓存索引文件，而不缓冲数据文件。据文件的缓存交给操作系统本身来完成。

3. NDB存储引擎

	NDB存储引擎是一个集群存储引擎，NDB存储引擎的特点是**数据全部放在内存中**，因此主键查找的速度非常快。 

4. Memory存储引擎

	(1)Memory存储引擎将表中的数据存放在内存中，如果数据库重启或发生崩溃，表中的数据都将消失。它适合用于**存储临时数据的临时表**，以及数据仓库中的纬度表。
	
	(2)Memory存储引擎默认使用**哈希索引**，而不是**Demo.B+树索引**。
	
	(3)虽然Memory存储引擎速度快，但是它支持表锁，并发性能较差，并且不支持TEXT和BLOB列类型。最重要的是，存储变长字段时是按照定常字段的方式进行的，因此会浪费内存。

5. Archive存储引擎

	Archive存储引擎只支持insert和select操作，从5.1版本开始支持索引。Archive存储引擎使用zlib算法将数据行进行压缩后存储，压缩比一般可达1:10。非常适用于存储归档数据，如日志信息。

6. Federated存储引擎

	Federated存储引擎并不存放数据，它只是指向一台远程MySql数据库服务器上的表。

7. Maria存储引擎

	(1)Maria存储引擎是新开发的引擎，设计目标主要是用来取代原有得到MyISAM存储引擎。 
	(2)Maria存储引擎的主要特点是：支持缓存数据和索引文件，应用了行锁设计，提供了MVCC功能，支持事务和非事务安全的选项，以及更好的BLOB字符类型的处理性能 。

## 四、连接MySQL ##

	管道，命令管道，命名字，TCP/IP套接字，UNIX域套接字。